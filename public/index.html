<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Travel Booking Form</title>
  <link rel="stylesheet" type="text/css" href="booking.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>

<body>



  <div class="cred-section">

    <button class="button-1" role="button" onclick="window.location.href = 'credentials/sign-in.html';">
      Sign In
    </button>
    <button class="button-1" role="button" onclick="window.location.href = 'credentials/sign-up.html';">
      Sign Up
    </button>

  </div>


  <section class="button-section">

    <div class="tab-container">

      <div class="tab-links-container">
        <button class="tab-link" onclick="openTab(event, 'book-flight')">Book a flight</button>
        <button class="tab-link" onclick="openTab(event, 'my-bookings')">My Bookings</button>
        <button class="tab-link" onclick="openTab(event, 'flight-status')">Flight Status</button>
        <button class="tab-link" onclick="openTab(event, 'flight-schedule')">Flight Schedule</button>
      </div>

      <!-- Tab 1 -->
      <div id="book-flight" class="tab-content">
        <form id="booking-form" method="post">

          <div class="form-row">

            <div class="form-section destination">
              <div class="airport-selector">
                <input type="text" class="airport-input" id="from-destination" placeholder="From">
                <div class="airport-dropdown airport-dropdown-1"></div>
              </div>
            </div>


            <div class="form-section swap-button-section" style="padding-left: 20px;">
              <button id="swap-destinations-button" class="swap-button" style="width: 60%;
              height: auto;
              aspect-ratio: 1/1;
              border-radius: 50%;
              background-color: var(--purple);
              border: none;
              cursor: pointer;">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#FFFFFF"
                  height="80%" width="80%" version="1.1" id="Layer_1" viewBox="0 0 512.04 512.04" xml:space="preserve">
                  <g>
                    <g>
                      <path
                        d="M508.933,248.353L402.267,141.687c-4.267-4.053-10.987-3.947-15.04,0.213c-3.947,4.16-3.947,10.667,0,14.827    l88.427,88.427H36.4l88.427-88.427c4.053-4.267,3.947-10.987-0.213-15.04c-4.16-3.947-10.667-3.947-14.827,0L3.12,248.353    c-4.16,4.16-4.16,10.88,0,15.04L109.787,370.06c4.267,4.053,10.987,3.947,15.04-0.213c3.947-4.16,3.947-10.667,0-14.827    L36.4,266.593h439.147L387.12,355.02c-4.267,4.053-4.373,10.88-0.213,15.04c4.053,4.267,10.88,4.373,15.04,0.213    c0.107-0.107,0.213-0.213,0.213-0.213l106.667-106.667C513.093,259.34,513.093,252.513,508.933,248.353z"
                        stroke="white" stroke-width="20" />
                    </g>
                  </g>
                </svg>
              </button>
            </div>


            <div class="form-section destination">
              <div class="airport-selector">
                <input type="text" class="airport-input" id="to-destination" placeholder="To">
                <div class="airport-dropdown airport-dropdown-2"></div>
              </div>
            </div>

          </div>



          <div class="form-row">

            <div class="form-section a-date">
              <input type="text" id="departure-date" name="departure-date" class="date-picker"
                placeholder="Departure Date" readonly>
            </div>


            <div class="form-section a-date">
              <input type="text" id="return-date" name="return-date" class="date-picker" placeholder="Return Date"
                readonly>
            </div>

            <div class="form-section">
              <label for="no-return-checkbox">
                 One-way
              </label>
              <input type="checkbox" id="no-return-checkbox" onchange="toggleTextInput()" name="no-return-checkbox">
            </div>

          </div>



          <div class="form-row">

            <div class="form-section">


              <div class="passenger-count">

                <button type="button" class="toggle-passenger-details" id="passenger-count">1 Adult</button>

                <div class="passenger-details">
                  <div>
                    <label for="adults">Adults:</label>
                    <div class="passenger-number-input" name="adults">
                      <button type="button" onclick="decrement('adults')">-</button>
                      <input type="text" id="adults" name="adults" value="1" readonly>
                      <button type="button" onclick="increment('adults')">+</button>
                    </div>
                  </div>

                  <div>
                    <label for="children">Children:</label>
                    <div class="passenger-number-input" name="children">
                      <button type="button" onclick="decrement('children')">-</button>
                      <input type="text" id="children" name="children" value="0" readonly>
                      <button type="button" onclick="increment('children')">+</button>
                    </div>
                  </div>

                  <div>
                    <label for="infants">Infants:</label>
                    <div class="passenger-number-input" name="infants">
                      <button type="button" onclick="decrement('infants')">-</button>
                      <input type="text" id="infants" name="infants" value="0" readonly>
                      <button type="button" onclick="increment('infants')">+</button>
                    </div>
                  </div>

                </div>
              </div>


            </div>

            <div class="form-section destination">
              <label for="class-selector">Class:</label>
              <select id="class-selector" name="class-selector">
                <option value="Economy">Economy</option>
                <option value="Business">Business</option>
                <option value="Executive">Executive</option>
                <!-- Add more options as needed -->
              </select>
            </div>

          </div>



          <button type="submit" id="submit-booking-details" class="submit-booking-details">Search Flights</button>

        </form>
      </div>

      <!-- Tab 2 -->
      <div id="my-bookings" class="tab-content">
        <!-- Content for My Bookings tab -->
      </div>

      <!-- Tab 3 -->
      <div id="flight-status" class="tab-content">
        <!-- Content for Flight Status tab -->
      </div>

      <!-- Tab 4 -->
      <div id="flight-schedule" class="tab-content">
        <!-- Content for Flight Schedule tab -->
        <form id="schedule-booking-form" method="post">

          <div class="form-row">

            <div class="form-section destination">
              <div class="airport-selector">
                <input type="text" class="airport-input" id="schedule-from-destination" placeholder="From">
                <div class="airport-dropdown airport-dropdown-1"></div>
              </div>
            </div>


            <div class="form-section swap-button-section" style="padding-left: 20px;">
              <button id="schedule-swap-destinations-button" class="swap-button" style="width: 60%;
              height: auto;
              aspect-ratio: 1/1;
              border-radius: 50%;
              background-color: var(--purple);
              border: none;
              cursor: pointer;">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#FFFFFF"
                  height="80%" width="80%" version="1.1" id="Layer_1" viewBox="0 0 512.04 512.04" xml:space="preserve">
                  <g>
                    <g>
                      <path
                        d="M508.933,248.353L402.267,141.687c-4.267-4.053-10.987-3.947-15.04,0.213c-3.947,4.16-3.947,10.667,0,14.827    l88.427,88.427H36.4l88.427-88.427c4.053-4.267,3.947-10.987-0.213-15.04c-4.16-3.947-10.667-3.947-14.827,0L3.12,248.353    c-4.16,4.16-4.16,10.88,0,15.04L109.787,370.06c4.267,4.053,10.987,3.947,15.04-0.213c3.947-4.16,3.947-10.667,0-14.827    L36.4,266.593h439.147L387.12,355.02c-4.267,4.053-4.373,10.88-0.213,15.04c4.053,4.267,10.88,4.373,15.04,0.213    c0.107-0.107,0.213-0.213,0.213-0.213l106.667-106.667C513.093,259.34,513.093,252.513,508.933,248.353z"
                        stroke="white" stroke-width="20" />
                    </g>
                  </g>
                </svg>
              </button>
            </div>


            <div class="form-section destination">
              <div class="airport-selector">
                <input type="text" class="airport-input" id="schedule-to-destination" placeholder="To">
                <div class="airport-dropdown airport-dropdown-2"></div>
              </div>
            </div>

          </div>
          <button type="submit" id="schedule-submit-booking-details" class="submit-booking-details">Search Flights</button>

        </form>
      </div>

    </div>


  </section>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>

const valid = true;
    // Sample list of airports (you can replace it with your own list)
    const airports = [
      "JFK - John F. Kennedy International Airport",
      "LAX - Los Angeles International Airport",
      "ORD - O'Hare International Airport",
      "ATL - Hartsfield-Jackson Atlanta International Airport",
      "DFW - Dallas/Fort Worth International Airport",
      "DEN - Denver International Airport",
      "SFO - San Francisco International Airport",
      "SEA - Seattle-Tacoma International Airport",
      "LAS - McCarran International Airport",
      "MIA - Miami International Airport"
    ];

    window.onload = () => {
      //Making the 'bookFlight' tab active initially
      document.getElementsByClassName("tab-content")[0].style.display = "block";
      document.getElementsByClassName("tab-link")[0].className += " active";
    }

    //Function for opening tab on click
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tab-content");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tab-link");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }


    document.addEventListener("DOMContentLoaded", function () {

      //Arrival and Departure Date Pickers
      flatpickr("#departure-date", {
        dateFormat: "d-m-Y",
        minDate: "today",
      });

      flatpickr("#return-date", {
        dateFormat: "d-m-Y",
        minDate: "today",
      });

      //Displaying Passenger Details
      document.getElementById('passenger-count').addEventListener('click', function () {
        document.querySelector('.passenger-details').classList.toggle('active');
      });

      //Making an object out of form data on submit
      document.getElementById('swap-destinations-button').addEventListener('click',
        function (event) {

          // Handle the form data
          event.preventDefault();
        });
      document.getElementById('booking-form').addEventListener('submit', function (event) {

        event.preventDefault();
        const nr = document.getElementById('no-return-checkbox').value;
        const from = document.getElementById('from-destination').value;
        const to = document.getElementById('from-destination').value;
        // validateBookAFlightForm();
        if (valid) {
          const formData = new FormData(this);
          formData.append('no-return', nr);
          formData.append('from', from);
          formData.append('to', to);
          const formObject = {};
          formData.forEach((value, key) => {
            formObject[key] = value;
          });
          console.log(formObject);
        }
      });

      //Schedule Tab
       //Making an object out of form data on submit
       document.getElementById('schedule-swap-destinations-button').addEventListener('click',
        function (event) {

          // Handle the form data
          event.preventDefault();
        });
      document.getElementById('schedule-booking-form').addEventListener('submit', function (event) {
        // validateBookAFlightForm();
        event.preventDefault();
        const from = document.getElementById('schedule-from-destination').value;
        const to = document.getElementById('schedule-from-destination').value;
        
        if (valid) {
          const scheduleFormData = new FormData(this);
          scheduleFormData.append('from', from);
          scheduleFormData.append('to', to);
          const scheduleFormObject = {};
          scheduleFormData.forEach((value, key) => {
            scheduleFormObject[key] = value;
          });
          console.log(scheduleFormObject);
        }
      });


      const airportInputs = document.querySelectorAll(".airport-input");

      airportInputs.forEach(function (airportInput) {
        const airportDropdown = airportInput.nextElementSibling;

        // Function to filter airports based on user input
        function filterAirports() {
          const searchText = airportInput.value.toLowerCase();
          const filteredAirports = airports.filter(airport => airport.toLowerCase().includes(searchText));
          displayAirports(filteredAirports);
          if (searchText.length === 0) return airportDropdown.classList.remove("active");

        }

        // Function to display filtered airports in the dropdown
        function displayAirports(airportsToShow) {
          const dropdownContent = airportsToShow.map(airport => `<div class="airport-option">${airport}</div>`).join("");
          airportDropdown.innerHTML = dropdownContent;
          airportDropdown.classList.add("active");
        }

        // Event listener for input changes
        airportInput.addEventListener("input", filterAirports);

        // Event listener for selecting an airport from dropdown
        airportDropdown.addEventListener("click", function (event) {
          if (event.target.classList.contains("airport-option")) {
            airportInput.value = event.target.textContent;
            airportDropdown.classList.remove("active");
          }
        });
        var currDestBox;
        airportInput.addEventListener("focus", () => { currDestBox = event.target; filterAirports(); }); // Show dropdown when input is focused
        document.addEventListener("click", function (event) {
          if (event.target != currDestBox && !event.target.classList.contains("airport-option")) {
            airportDropdown.classList.remove("active");
          }
        });
      });

    });


    // Function to disable/enable text input based on checkbox state
    function toggleTextInput() {
      var checkbox = document.getElementById("no-return-checkbox");
      var textInput = document.getElementById("return-date");

      if (checkbox.checked) {
        textInput.style.cursor = "default";
        textInput.disabled = true;
      } else {
        textInput.style.cursor = "pointer";
        textInput.disabled = false;
      }
    }

    //Incrementing and Decrementing passenger count on clicking respective buttons
    function increment(field) {
      const input = document.getElementById(field);
      input.value = parseInt(input.value) + 1;
      updateTotalPassengers();
    }

    function decrement(field) {
      const input = document.getElementById(field);
      const value = parseInt(input.value) - 1;
      input.value = value >= 0 ? value : 0;
      updateTotalPassengers();
    }

    //Swap Source and Destination on click
    document.getElementById('swap-destinations-button').addEventListener('click', function () {
      const fromDestination = document.getElementById('from-destination').value;
      const toDestination = document.getElementById('to-destination').value;
      document.getElementById('from-destination').value = toDestination;
      document.getElementById('to-destination').value = fromDestination;
    });

    //Swap Source and Destination on click (Flight Schedule Tab)
    document.getElementById('schedule-swap-destinations-button').addEventListener('click', function () {
      const fromDestination = document.getElementById('schedule-from-destination').value;
      const toDestination = document.getElementById('schedule-to-destination').value;
      document.getElementById('schedule-from-destination').value = toDestination;
      document.getElementById('schedule-to-destination').value = fromDestination;
    });

    //Update the total number of passengers after incrementing or decrementing
    function updateTotalPassengers() {
      const adults = parseInt(document.getElementById('adults').value);
      const children = parseInt(document.getElementById('children').value);
      // const infants = parseInt(document.getElementById('infants').value);
      const total = adults + children;
      document.getElementById('passenger-count').textContent = total + " Passenger" + (total !== 1 ? "s" : "");
    }

  </script>

</body>

</html>